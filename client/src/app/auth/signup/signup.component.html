<div class="form-container">
    <form [formGroup]="signupForm" (ngSubmit)="handleSignup()" class="signup-form">
        <h2 class="gradient-text" style="text-align: center; font-size: 1.75rem"
            >Create new account</h2
        >

        <!-- Username -->
        <mat-form-field appearance="outline" [hideRequiredMarker]="true" class="form-field">
            <mat-label>Username</mat-label>
            <input type="text" matInput formControlName="username" />
            @if (
                signupForm.get("username")?.touched &&
                signupForm.get("username")?.hasError("required")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Username is required
                </mat-error>
            } @else if (
                signupForm.get("username")?.touched &&
                signupForm.get("username")?.hasError("minlength")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Username must be at least 3 characters
                </mat-error>
            }
        </mat-form-field>

        <!-- Email -->
        <mat-form-field appearance="outline" [hideRequiredMarker]="true" class="form-field">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" />
            @if (
                signupForm.get("email")?.touched && signupForm.get("email")?.hasError("required")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Email is required
                </mat-error>
            } @else if (
                signupForm.get("email")?.touched && signupForm.get("email")?.hasError("email")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Please enter a valid email address
                </mat-error>
            }
        </mat-form-field>

        <!-- Password -->
        <mat-form-field appearance="outline" [hideRequiredMarker]="true" class="form-field">
            <mat-label>Password</mat-label>
            <input matInput type="password" formControlName="password" />
            @if (
                signupForm.get("password")?.touched &&
                signupForm.get("password")?.hasError("required")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Password is required
                </mat-error>
            } @else if (
                signupForm.get("password")?.touched &&
                signupForm.get("password")?.hasError("minlength")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Password must be at least 6 characters
                </mat-error>
            }
        </mat-form-field>

        <!-- Confirm Password -->
        <mat-form-field appearance="outline" [hideRequiredMarker]="true" class="form-field">
            <mat-label>Confirm Password</mat-label>
            <input matInput type="password" formControlName="confirmPassword" />
            @if (
                signupForm.get("confirmPassword")?.touched &&
                signupForm.get("confirmPassword")?.hasError("required")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Confirm password is required
                </mat-error>
            } @else if (
                signupForm.get("confirmPassword")?.touched &&
                signupForm.get("confirmPassword")?.hasError("mismatch")
            ) {
                <mat-error class="field-error">
                    <mat-icon
                        aria-hidden="false"
                        aria-label="error icon"
                        fontIcon="error_outline"
                        style="font-size: 0.875rem"
                    ></mat-icon>
                    Passwords do not match
                </mat-error>
            }
        </mat-form-field>

        <!-- Role -->
        <mat-form-field appearance="outline" [hideRequiredMarker]="true" class="form-field">
            <mat-label>Choose a role</mat-label>
            <mat-select formControlName="role">
                <mat-option value="user">User</mat-option>
                <mat-option value="admin">Admin</mat-option>
            </mat-select>
        </mat-form-field>

        <!-- Action section -->
        <div
            style="display: flex; align-items: center; justify-content: space-between; gap: 1.25rem"
        >
            <button
                mat-flat-button
                type="submit"
                [disabled]="isSubmitting()"
                style="flex: 1; padding-block: 1.375rem"
            >
                {{ isSubmitting() ? "Creating account..." : "Sign Up" }}
            </button>
        </div>
        <p style="text-align: center">
            Already have an account?
            <a routerLink="/login" class="auth-link" style="color: var(--primary)">Login</a>
        </p>
    </form>
</div>
